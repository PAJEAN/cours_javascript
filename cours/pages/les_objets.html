<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Le JavaScript</title>
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <div class="wrapper">
        <div class="page" id="page">
            <header>
                <h1 class="title">Les objets</h1>
                <div class="toolbar">
                    <button class="btn" id="btn-print" title="Imprimer / Exporter en PDF">üñ®Ô∏è Imprimer</button>
                    <button class="btn" id="btn-theme" title="Changer le th√®me" data-initial="light">üåó Th√®me</button>
                </div>
            </header>

            <!-- ----------------------------------------------------------------------- -->
            <!--                               Les objets                                -->
            <!-- ----------------------------------------------------------------------- -->

            <p> Un objet est un ensemble de propri√©t√©s, o√π chaque propri√©t√© associe un nom (ou cl√©) √† une valeur. Si cette valeur est une fonction, la propri√©t√© est alors appel√©e m√©thode. Le nom d‚Äôune propri√©t√© peut √™tre une cha√Æne de caract√®res ou un nombre. </p>

            <h2> Cr√©ation d'un objet </h2>

            Il y a plusieurs fa√ßon de cr√©er un objet (notamment depuis ES6).

            <div id="cells74"></div>

            <p> Une fa√ßon alternative de cr√©er une instance de <code>Object</code> au travers de son constructeur est d'exploiter le mot-cl√© <code>new</code>. </p>

            <div id="cells75"></div>

            <p> Les deux pr√©c√©dentes m√©thodes ne sont pas les plus courantes lorsque nous devons g√©n√©raliser l'objet que nous manipulons (c'est-√†-dire utiliser l'objet comme un <i>template</i> - classe - pour cr√©er de nouveaux objets). Dans ce cas, il faut d√©finir un <b>constructeur</b> personnalis√©. </p>

            <p> Les constructeurs, comme la plupart des autres langages orient√©s objets, <b>fournissent un <i>template</i> pour cr√©er des objets</b>. En d'autres termes, ils d√©finissent un ensemble de propri√©t√©s et m√©thodes qui pourrait √™tre commun √† tous les objets initialis√©s par le constructeur. </p>

            <div id="cells76"></div>

            <p> Depuis la sp√©cification ECMAScript 6 (pour information ES6 a √©t√© valid√© et publi√© le 17 juin 2015) une syntaxe alternative a √©t√© introduite pour cr√©er des objets et g√©rer l'h√©ritage. </p>

            <div id="cells77"></div>

            <p> Toutes les fonctions en JavaScript ont une propri√©t√© sp√©ciale intitul√©e <b>prototype</b>. </p>

            <div id="cells78"></div>

            <h2> H√©ritage et la cha√Æne de prototypage </h2>

            <p> JavaScript est un langage orient√© prototype, qui est un style de programmation orient√© objet. Les prototypes sont un m√©canisme au sein de JavaScript qui permettent aux objets JavaScript d'h√©riter des propri√©t√©s d'autres objets. </p>

            <h3> Propri√©t√©s h√©rit√©es </h3>

            <p> Chaque objet poss√®de une propri√©t√© priv√©e qui contient un lien vers un autre objet appel√© le <b>prototype</b>. Ce prototype poss√®de √©galement son prototype et ainsi de suite, jusqu'√† ce qu'un objet ait <code>null</code> comme prototype. Les objets JavaScript sont des instances de <code>Object</code> qui est l'avant dernier maillon de la cha√Æne de prototype. </p>

            <p> Lorsqu'on explore l'<b>instance</b> d'un objet, nous rencontrons le mot-cl√© <b><code>__proto__</code></b>. Ce mot-cl√© est un objet qui pointe vers le prototype qui l'a cr√©√©. </p>

            <div id="cells79"></div>

            <p> Les propri√©t√©s directement rattach√©es √† un objet sont appel√©es propri√©t√©s propres (<i>own properties</i>). Lorsqu'on tente d'acc√©der aux propri√©t√©s d'une instance d'un objet, la propri√©t√© sera recherch√©e tout d'abord sur ses propri√©t√©s propres puis sur son prototype, puis sur le prototype du prototype et ainsi de suite jusqu'√† ce qu'elle soit trouv√©e ou que la fin de la cha√Æne de prototype ait √©t√© atteinte. </p>

            <div id="cells80"></div>

            <p> Il est possible d'utiliser la fonction <code>call()</code> de l'objet <code>Function</code> pour cha√Æner le constructeur d'un objet. </p>

            <div id="cells81"></div>

            <h3> M√©thodes h√©rit√©es </h3>

            <p> En JavaScript, toute fonction associ√©e √† un objet est √©galement une propri√©t√©. Par cons√©quent, une fonction h√©rit√©e se comportera comme n'importe quelle autre propri√©t√©. </p>

            <p> Par exemple, le <code>__proto__</code> d'un tableau pointe vers le prototype de l'objet <code>Array</code>. C'est pourquoi, un tableau h√©rite de toutes les propri√©t√©s et m√©thodes de l'objet <code>Array</code> (<code>length</code>, <code>map</code>, etc.). </p>

            <p> La programmation orient√©e prototype offre, par cons√©quent, la possibilit√© d'ajouter des m√©thodes √† tout moment en dehors de la fonction constructeur. Il est possible par exemple d'ajouter une m√©thode au prototype de l'objet <code>Array</code> (cette pratique, d'ajouter des fonctions aux objets natifs, est cependant d√©conseill√©e). </p>

            <div id="cells82"></div>

            <p> Voici un exemple complet d'h√©ritage avant la version ES6. </p>

            <div id="cells83"></div>

            <p> Voici un exemple complet d'h√©ritage apr√®s la version ES6. Le sucre syntaxique ajout√© lors de la version ES6 exploite le mot-cl√© <code>extends</code> pour h√©riter des attributs et des m√©thodes d'une classe. </p>

            <div id="cells84"></div>
            
            <div class="nota-bene-box">
                <div class="nota-bene-header">
                    <span class="box-icon">üìù</span>
                    <span class="box-title">√Ä savoir</span>
                </div>
                <div class="box-content">
                    <p> JavaScript ne supporte pas l'h√©ritage multiple. </p>
                </div>
            </div>
            
            <h3> M√©thodes statiques </h3>

            <p> Le mot-cl√© <code>static</code> permet de d√©finir une m√©thode statique d'une classe. Les m√©thodes statiques ne sont pas disponibles sur les instances d'une classe mais sont appel√©es sur la classe elle-m√™me. Les m√©thodes statiques sont g√©n√©ralement des fonctions utilitaires (qui peuvent permettre de cr√©er ou de cloner des objets par exemple). </p>

            <div id="cells85"></div>

            <h3> La copie d'un objet </h3>

            <p> Les <b>objets en JavaScript sont muables</b>. La copie d'un objet <b>s'effectue par r√©f√©rence</b> et non par valeur. </p>

            <div id="cells86"></div>

            <div id="cells87"></div>

            <p> La m√©thode <code>Object.assign()</code> est utilis√©e afin de copier les valeurs de toutes les propri√©t√©s propres d'un objet qui sont √©num√©rables sur une autre objet. </p>

            <div id="cells88"></div>

            <h3> Le mot-cl√© <code>this</code> </h3>

            <p> Lorsque l'on manipule des objets, le mot-cl√© <code>this</code> est utilis√© avec les m√©thodes de l'objet pour acc√©der √† des informations stock√©es dans l'objet. Le mot-cl√© <code>this</code> va dans ce cas √™tre substitu√© par l‚Äôobjet utilisant la m√©thode lors de son appel. </p>

            <p> Pour aller plus loin, vous devez savoir qu'en JavaScript, √† la diff√©rence de la plupart des langages, le mot-cl√© <code>this</code> n'est pas li√© √† un objet en particulier. En effet, la valeur de <code>this</code> va √™tre √©valu√©e au moment de l‚Äôappel de la m√©thode dans laquelle il est pr√©sent en JavaScript. </p>

            <p> Ainsi, la valeur de <code>this</code> ne va pas d√©pendre de l'endroit o√π la m√©thode a √©t√© d√©clar√©e mais de l'objet qui l‚Äôappelle. Cela permet notamment √† une m√©thode d'√™tre r√©utilis√©e par diff√©rents objets. </p>

            <div id="cells89"></div>

            <p> <code>this</code> est un op√©rateur qui permet de retourner une valeur en fonction de son contexte <i>confer</i> <a href="../../exemples/this/this.html">l'exemple suivant</a>. </p>

            <div class="exercise-box">
                <div class="exercise-header">
                    <span class="box-icon">üí°</span>
                    <span class="box-title">Exercice</span>
                </div>
                <div class="box-content">
                    <ul>
                        <li> Rendez-vous au lien suivant: <b>https://github.com/PAJEAN/cours_javascript/tree/master/exemples/bfs</b> pour r√©aliser le TP sur le parcours en largeur de graphe. </li>
                    </ul>
                </div>
            </div>

        </div>
    </div>


<!--
88888888888                              888          888            
    888                                  888          888            
    888                                  888          888            
    888   .d88b.  88888b.d88b.  88888b.  888  8888b.  888888 .d88b.  
    888  d8P  Y8b 888 "888 "88b 888 "88b 888     "88b 888   d8P  Y8b 
    888  88888888 888  888  888 888  888 888 .d888888 888   88888888 
    888  Y8b.     888  888  888 888 d88P 888 888  888 Y88b. Y8b.     
    888   "Y8888  888  888  888 88888P"  888 "Y888888  "Y888 "Y8888  
                                888                                  
                                888                                  
                                888                                  
-->

    <template id="cell-template">
        <section class="cell">
            <header>
                <div class="cell-title">
                    <span class="badge">
                        <span class="dot"></span>
                        <span class="title-text">JavaScript</span>
                    </span>
                </div>
                <div class="cell-actions">
                    <button class="btn run">
                        <span class="icon">‚ñ∂</span>
                        <span class="label">Ex√©cuter</span>
                    </button>
                    <button class="btn reset">
                        <span class="icon">‚ü≥</span>
                        <span class="label">R√©initialiser</span>
                    </button>

                    <button class="btn clear">
                        <span class="icon">üßπ</span>
                        <span class="label">Effacer</span>
                    </button>
                </div>
            </header>
            <textarea class="editor" spellcheck="false"></textarea>
            <div class="output" aria-live="polite"></div>
        </section>
    </template>


<!--
 .d8888b.                   d8b          888    
d88P  Y88b                  Y8P          888    
Y88b.                                    888    
 "Y888b.    .d8888b 888d888 888 88888b.  888888 
    "Y88b. d88P"    888P"   888 888 "88b 888    
      "888 888      888     888 888  888 888    
Y88b  d88P Y88b.    888     888 888 d88P Y88b.  
 "Y8888P"   "Y8888P 888     888 88888P"   "Y888 
                                888             
                                888             
                                888             
-->

    <script src="../js/main.js"></script>

    <script>
        /* ==== Add cells ==== */
   
    addCell('cells74', 'Syntaxe litt√©rale', `
let ma_cle = 'nom_magicien';
let heros = {
    nom: 'Geralt', //Propri√©t√© de l'objet.
    profession: 'Sorceleur', // Propri√©t√© de l'objet.
    10: 'Une partie de Gwent ?', // Propri√©t√© de l'objet.
    'monstres tu√©s': 134, // Propri√©t√© de l'objet.
    direBonjour: function() { // M√©thode de l'objet.
        console.log('Humm !');
    },
    [ma_cle]: 'Yennefer' // Instanciation d'une cl√© 
}
console.log(heros.nom);
console.log(heros[10]);
console.log(heros['monstres tu√©s']);
heros.direBonjour();
console.log(heros[ma_cle]);
console.log(heros.nom_magicien);
    `);

    addCell('cells75', 'Constructeur <code>Object</code>', `
let heros = new Object(); // On cr√©√© une instance de Object gr√¢ce √† son constructeur.
heros.nom = 'Geralt'; // Propri√©t√©.
heros.direBonjour = function() { // M√©thode de l'objet.
    console.log('Humm !');
};
heros.direBonjour();
    `);

    addCell('cells76', 'Constructeur personnalis√©', `
function afficher() {
    console.log(this.nom + ' ' + this.age);
}

function Animal(nom, age) { // Constructeur.
    this.nom = nom;
    this.age = age;
    // D√©finition de la m√©thode toString √† partir de la fonction afficher.
    this.toString = afficher;
}

let animal1 = new Animal('Flipper', 8);
let animal2 = new Animal('Beethoven', 4);
console.log(animal1.nom);
console.log(animal2.nom);

// Utilisation de la m√©thode toString().
animal1.toString();
    `);

    addCell('cells77', 'Constructeur personnalis√© (syntaxe alternative)', `
class Animal {
    constructor(nom, age) {
        this.nom = nom;
        this.age = age;
    }

    // D√©finition de la m√©thode toString().
    toString() {
        console.log(this.nom + ' ' + this.age);
    }
}

var animal1 = new Animal('Flipper', 8);
console.log(animal1.nom);
animal1.toString();
    `);

    addCell('cells78', 'Propri√©t√© <code>prototype</code>', `
function Animal(nom) { // Constructeur.
    this.nom = nom;
}

console.log(Animal.prototype);
    `);

    addCell('cells79', 'Cha√Æne de prototypage (1/2)', `
function creation_objet(){
    this.a = "A";
};
var un_objet = new creation_objet();
// Protoype de creation_objet.
console.log('Prototype de un_objet :');
console.log(un_objet.__proto__);
// Prototype de Object.
console.log('Prototype de Object: ');
console.log(un_objet.__proto__.__proto__);
// Fin de la cha√Æne de prototypage.
console.log('Prototype du prototype de Object: ');
console.log(un_objet.__proto__.__proto__.__proto__ );
    `);

    addCell('cells80', 'Cha√Æne de prototypage (2/2)', `
let un_objet = function(){
    this.a = 1;
    this.b = 2;
}

un_objet.prototype.b = 3;
un_objet.prototype.c = 4;

let o1 = new un_objet();

// Quelles sont les sorties de ces instructions ?
console.log('o1.a ' + o1.a);
console.log('o1.b ' + o1.b);
/* Je n'ai pas la propri√©t√© "c" dans mes propri√©t√©s propres
Je remonte la cha√Æne de prototypage, est ce que le prototype de mon constructeur (un_objet) a cette propri√©t√© ?
Oui la propri√©t√© est pr√©sente, je l'affiche */
console.log('o1.c ' + o1.c);
    `);

    addCell('cells81', 'H√©ritage et cha√Æne de prototypage', `
function afficher() {
    console.log(this.nom + ' ' + this.age);
}

function Animal(nom, age) { // Cr√©ation d'une fonction constructeur.
    this.nom = nom;
    this.age = age;
    this.toString = afficher;
}

function Chien(nom, age, race) {
    Animal.call(this, nom, age); // H√©ritage des attributs.
    // Dans le cas o√π le constructeur de Animal n'a pas de param√®tre, nous pouvons √©crire Animal.call(this).
    this.race = race;
}

var animal1 = new Animal('Flipper', 8);
var chien1 = new Chien('Beethoven' , 4, "Saint-Bernard");

console.log(animal1.nom + ' et ' + chien1.nom);
chien1.toString();
    `);

    addCell('cells82', 'Extension du prototype', `
function Animal(nom, age) { // Cr√©ation d'une fonction constructeur.
    this.nom = nom;
    this.age = age;
}

Animal.prototype.manger = function() { 
    console.log(this.nom + ' est en train de manger.');
}

var animal1 = new Animal('Flipper', 4);
animal1.manger();
/* La propri√©t√© (m√©thode) manger() n'est pas pr√©sent dans les propri√©t√©s propres
on remonte vers le prototype de Animal */
    `);

    addCell('cells83', 'H√©ritage', `
function Animal(nom, age){ // Cr√©ation d'une fonction constructeur.
    this.nom = nom;
    this.age = age;
}

Animal.prototype.manger = function() { 
    console.log(this.nom + " est en train de manger. <br>");
}

function Chien(nom, age, race) {
    Animal.call(this, nom, age); // H√©ritage des attributs.
    this.race = race;
}

Chien.prototype = Object.create(Animal.prototype); // H√©ritage des m√©thodes.

var chien1 = new Chien('Snoopy', 10, 'Labrador');
console.log(chien1.nom + ' est un(e) ' + chien1.race);

chien1.manger();

Animal.prototype.getAge = function() {
    return this.age;
}

console.log(chien1.getAge());
    `);

    addCell('cells84', 'H√©ritage (syntaxe alternative)', `
class Animal{
    constructor(nom, age){
        this.nom = nom;
        this.age = age;
    }
    
    manger(){
        console.log(this.nom + ' est en train de manger.');
    }
}

class Chien extends Animal{
    constructor(nom, age, race){
        super(nom, age);
        this.race = race;
    }
    
    manger(){
        super.manger();
        console.log('Il mange des croquettes.');
    }
    
}

var chien1 = new Chien('Snoopy', 10, 'Labrador');
console.log(chien1.nom);
chien1.manger();
    `);

    addCell('cells85', 'Attribut et m√©thode statiques', `
class Animal {
    static cost = 100;

    constructor(nom, age) {
        this.nom = nom;
        this.age = age;
        Animal.count++;
    }
    
    manger() {
        console.log(this.nom + ' est en train de manger.');
    }
    
    static Count() {
        return Animal.count;
    }
}

console.log(Animal.cost);

Animal.count = 0; // D√©claration de l'attribut statique.

var animal1 = new Animal('Flipper', 8);
console.log(Animal.Count());
var animal2 = new Animal('Snoopy', 10);
console.log(Animal.Count());

/* == Cette instruction est-elle viable ? == */

animal2.Count();
    `);

    addCell('cells86', 'Copie par r√©f√©rence', `
function Animal(nom, age) { // Cr√©ation d'une fonction constructeur.
    this.nom = nom;
    this.age = age;
}

var animal1 = new Animal('Flipper', 8);
// Adressage par r√©f√©rence.
var animal2 = animal1;

/* == Quel sera le r√©sultat ? == */

console.log(animal1.nom + ' ' + animal2.nom);

animal2.nom = "Beethoven";

console.log(animal1.nom + ' ' + animal2.nom);
    `);

        addCell('cells87', 'Copie par valeur', `
var str1 = 'Hello';
// Adressage par valeur.
var str2 = str1;

// Quel sera le r√©sultat ?
console.log(str1);
console.log(str2);

str2 = 'World';

console.log(str1);
console.log(str2);
    `);

    addCell('cells88', 'M√©thode <code>assign()</code>', `
function Animal(nom, age) { // Cr√©ation d'une fonction constructeur.
    this.nom = nom;
    this.age = age;
}

var animal1 = new Animal('Flipper', 8);
var animal2 = Object.assign(Animal, animal1);

/* == Quel sera le r√©sultat ? == */
console.log(animal1.nom + ' ' + animal2.nom);

animal2.nom = "Beethoven";

console.log(animal1.nom + ' ' + animal2.nom);
    `);

    addCell('cells89', '', `
let pierre = {name: 'Pierre'};
let mathilde = {name: 'Mathilde'};

function disBonjour(){
  console.log('Bonjour ' + this.name);
}

pierre.bonjour = disBonjour;
mathilde.bonjour = disBonjour;

pierre.bonjour();
mathilde.bonjour();
    `);
    
/*        
    addCell('cells00', '', `

    `);
*/

    </script>
</body>
</html>